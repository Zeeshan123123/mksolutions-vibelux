{
  "name": "vibelux-simple-build",
  "description": "Build simple VibeLux Docker image",
  "source": {
    "type": "NO_SOURCE",
    "buildspec": "version: 0.2\nphases:\n  pre_build:\n    commands:\n      - echo Logging in to Amazon ECR...\n      - aws ecr get-login-password --region $AWS_DEFAULT_REGION | docker login --username AWS --password-stdin $AWS_ACCOUNT_ID.dkr.ecr.$AWS_DEFAULT_REGION.amazonaws.com\n      - REPOSITORY_URI=$AWS_ACCOUNT_ID.dkr.ecr.$AWS_DEFAULT_REGION.amazonaws.com/$IMAGE_REPO_NAME\n      - COMMIT_HASH=$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | cut -c 1-7)\n      - IMAGE_TAG=${COMMIT_HASH:=latest}\n  build:\n    commands:\n      - echo Build started on `date`\n      - echo Creating simple VibeLux homepage...\n      - mkdir -p public\n      - |+\n        cat > public/vibelux-homepage.html << 'EOF'\n        <!DOCTYPE html>\n        <html lang=\"en\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n            <title>VibeLux - AI Platform for Agriculture</title>\n            <style>\n                * { margin: 0; padding: 0; box-sizing: border-box; }\n                body { \n                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n                    background: #0f172a; \n                    color: white; \n                    line-height: 1.6;\n                    text-align: center;\n                    padding: 4rem 2rem;\n                }\n                .container { max-width: 800px; margin: 0 auto; }\n                h1 { \n                    font-size: 3rem; \n                    font-weight: bold; \n                    margin-bottom: 1.5rem;\n                    background: linear-gradient(135deg, #10b981, #3b82f6);\n                    background-clip: text;\n                    -webkit-background-clip: text;\n                    -webkit-text-fill-color: transparent;\n                }\n                p { font-size: 1.25rem; color: #94a3b8; margin-bottom: 2rem; }\n                .btn { \n                    display: inline-block;\n                    padding: 1rem 2rem; \n                    background: linear-gradient(135deg, #10b981, #3b82f6);\n                    color: white; \n                    text-decoration: none; \n                    border-radius: 0.5rem; \n                    font-weight: 600;\n                    margin: 0.5rem;\n                }\n                .stats { \n                    display: grid; \n                    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); \n                    gap: 1rem; \n                    margin: 3rem 0;\n                }\n                .stat { padding: 1rem; background: rgba(30, 41, 59, 0.3); border-radius: 0.5rem; }\n                .stat-number { font-size: 2rem; font-weight: bold; color: #10b981; }\n            </style>\n        </head>\n        <body>\n            <div class=\"container\">\n                <h1>VibeLux</h1>\n                <p>The AI Platform for Agriculture</p>\n                <p>Professional horticultural technology suite with advanced lighting design, CFD analysis, and comprehensive business intelligence.</p>\n                \n                <div class=\"stats\">\n                    <div class=\"stat\">\n                        <div class=\"stat-number\">1600+</div>\n                        <div>Features</div>\n                    </div>\n                    <div class=\"stat\">\n                        <div class=\"stat-number\">437</div>\n                        <div>API Routes</div>\n                    </div>\n                    <div class=\"stat\">\n                        <div class=\"stat-number\">Live</div>\n                        <div>Production</div>\n                    </div>\n                </div>\n                \n                <a href=\"/design\" class=\"btn\">üé® Design Studio</a>\n                <a href=\"/dashboard\" class=\"btn\">üìä Dashboard</a>\n                <a href=\"/cfd\" class=\"btn\">üå™Ô∏è CFD Analysis</a>\n                \n                <div style=\"margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #334155;\">\n                    <p style=\"color: #64748b; font-size: 1rem;\">Complete platform launching soon ‚Ä¢ Professional greenhouse solutions</p>\n                </div>\n            </div>\n        </body>\n        </html>\n        EOF\n      - echo Creating Dockerfile...\n      - |+\n        cat > Dockerfile << 'EOF'\n        FROM nginx:alpine\n        RUN apk add --no-cache curl\n        COPY public/vibelux-homepage.html /usr/share/nginx/html/index.html\n        RUN echo 'server { listen 3000; server_name localhost; root /usr/share/nginx/html; index index.html; location / { try_files $uri $uri.html $uri/ /index.html; } location /health { return 200 \"healthy\"; add_header Content-Type text/plain; } }' > /etc/nginx/conf.d/default.conf\n        EXPOSE 3000\n        HEALTHCHECK --interval=30s --timeout=10s --start-period=15s --retries=3 CMD curl -f http://localhost:3000/health || exit 1\n        CMD [\"nginx\", \"-g\", \"daemon off;\"]\n        EOF\n      - echo Building Docker image...\n      - docker build -t $IMAGE_REPO_NAME:$IMAGE_TAG .\n      - docker tag $IMAGE_REPO_NAME:$IMAGE_TAG $REPOSITORY_URI:$IMAGE_TAG\n      - docker tag $IMAGE_REPO_NAME:$IMAGE_TAG $REPOSITORY_URI:latest\n  post_build:\n    commands:\n      - echo Build completed on `date`\n      - echo Pushing the Docker image...\n      - docker push $REPOSITORY_URI:$IMAGE_TAG\n      - docker push $REPOSITORY_URI:latest\nartifacts:\n  files:\n    - imagedefinitions.json"
  },
  "artifacts": {
    "type": "NO_ARTIFACTS"
  },
  "environment": {
    "type": "LINUX_CONTAINER",
    "image": "aws/codebuild/amazonlinux2-x86_64-standard:5.0",
    "computeType": "BUILD_GENERAL1_MEDIUM",
    "privilegedMode": true,
    "environmentVariables": [
      {
        "name": "AWS_DEFAULT_REGION",
        "value": "us-east-1"
      },
      {
        "name": "AWS_ACCOUNT_ID",
        "value": "397139395365"
      },
      {
        "name": "IMAGE_REPO_NAME",
        "value": "vibelux-production"
      }
    ]
  },
  "serviceRole": "arn:aws:iam::397139395365:role/codebuild-service-role"
}